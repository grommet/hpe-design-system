import { Button, Notification } from 'grommet';
import { FormNext } from 'grommet-icons';
import { BestPracticeGroup, Example, StyleTable } from '../../../layouts';
import {
  ActionLabels,
  ActionLabelTitle,
  DoubleConfirmationAnatomy,
  DoubleConfirmationExample,
  LayerAnatomy,
  LayerExample,
  LayerCenterExample,
  LayerNotificationExample,
  LayerSideDrawerExample,
  LayerStickyExample,
  LayerStickyScrollExample,
  ActionableLayerClose,
  InformationalLayerClose,
  LayerTypes,
} from '../../../examples';

<Example
  componentName="Layer"
  docs="https://v2.grommet.io/layer?theme=hpe#props"
  code="https://raw.githubusercontent.com/grommet/hpe-design-system/master/aries-site/src/examples/components/layer/LayerExample.js"
  figma="https://www.figma.com/file/Ts53TAipMolmsv9DxWG3p0/HPE-Layer-Component?node-id=2%3A22"
  grommetSource="https://github.com/grommet/grommet/blob/master/src/js/components/Layer/Layer.js"
>
  <LayerExample />
</Example>

## When to use

A layer should be used to present information or task flows to the user without navigating them away from their current context.

## Anatomy

Basic anatomy and spacing that applies to all [layer types](#types-of-layers).

<Example plain>
  <LayerAnatomy />
</Example>

| Label  | Region       | Purpose                                                | Required? | Notes                                                                      |
| ------ | ------------ | ------------------------------------------------------ | --------- | -------------------------------------------------------------------------- |
| **1**  | **Header**   | Identifies the layer.                                  | required  | --                                                                         |
| **1a** | **Title**    | A short, descriptive title identifying the layer.      | required  | Implemented as a Heading level 2, size="small".                            |
| **1b** | **Subtitle** | Any additional context or information about the layer. | optional  | --                                                                         |
| **2**  | **Body**     | Any additional content.                                | optional  | --                                                                         |
| **3**  | **Footer**   | Contains layer actions.                                | optional  | The ordering and alignment of footer actions depends on the type of layer. |

<StyleTable
  data={[
    {
      label: 4,
      property: 'pad',
      value: 'medium',
    },
    {
      label: 5,
      property: 'gap',
      value: 'medium',
    },
    {
      label: 6,
      property: 'round',
      value: 'small',
    },
    {
      label: 7,
      property: 'elevation',
      value: 'large',
    },
  ]}
/>

## Types of layers

Different use cases and content warrant different layer types. Learn more about each type below.

<LayerTypes />

## Avoid losing user's work

When a user attempts to close out of a layer, the layer closing behavior should always avoid losing user's work.

Therefore, when data has been edited or changed and the user tries to close the layer, a double confirmation should be shown.

| Layer state                             | Confirmation type   | Notes                                                                                                                                                                                                                      |
| --------------------------------------- | ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| User has not input or changed any data. | No confirmation     | The user will not lose anything if the layer closes immediately.                                                                                                                                                           |
| User has input or changed data.         | Double confirmation | The double confirmation should show when the user clicks the "X" or Cancel button, clicks outside of the layer, or presses the Escape key. This short confirmation ensures that user's work won't unintentionally be lost. |

### Double confirmation anatomy

A double confirmation appears as a center layer. This placement puts the confirmation at the center of the user's attention, reinforcing the importance of the dialog's prompt and minimizing distractions from other page content.

<Example plain>
  <DoubleConfirmationAnatomy />
</Example>

| Label  | Region       | Purpose                                                              | Required? | Notes                                                                                                      |
| ------ | ------------ | -------------------------------------------------------------------- | --------- | ---------------------------------------------------------------------------------------------------------- |
| **1a** | **Title**    | Explains that data will be discarded when the user closes the layer. | required  | --                                                                                                         |
| **1b** | **Subtitle** | To clarify that changes will not be saved.                           | required  | --                                                                                                         |
| **2**  | **Footer **  | Contains two actions: "Cancel" and "Discard"                         | required  | The actions should be right-aligned with primary action on the right, to align with center layer guidance. |

### Double confirmation example

<Example code="jkl">
  <DoubleConfirmationExample />
</Example>

## Modal vs. non-modal

When a layer is modal, a translucent overlay appears behind the layer and covers the rest of the page content to block the user from interacting with the page until the layer is closed.

Actionable layers should always be modal to ensure user focus is on the layer content and required actions. Modal is the default behavior of a layer.

When a layer is non-modal, there is no translucent overlay that covers the page content, and the page can still be interacted with.

Informational layers can be non-modal. To implement, apply `modal={false}` to the layer.

## Action label conventions

If a layer contains footer actions, the primary action should be labeled using verb + noun format (e.g., "Apply filters").

The noun may be omitted from actions labels beyond the primary action if the action is clear and unambiguous (e.g. "Reset" instead of "Reset filters").

When in doubt, follow the verb + noun convention to ensure clarity. See [button labeling guidance](/components/button#button-labeling) for more details.

<BestPracticeGroup>
  <Example
    height={{ min: 'small' }}
    bestPractice={{
      type: 'do',
      message:
        'When secondary actions are clear and unambiguous, you can omit the noun. In this case, "filters" is not repeated for the reset action.',
    }}
    width="100%"
  >
    <ActionLabels />
  </Example>
  <Example
    height={{ min: 'small' }}
    bestPractice={{
      type: 'dont',
      message: `Don’t remove the noun from the primary action as this can cause ambiguity about what the actions refer to.`,
    }}
    width="100%"
  >
    <ActionLabels bestPractice={false} />
  </Example>
</BestPracticeGroup>

### Aligning to layer title

The primary action verb should match the verb in the layer's title.

<BestPracticeGroup>
  <Example
    height={{ min: 'small' }}
    bestPractice={{
      type: 'do',
      message: `Match the primary action verb to that of the layer's title.`,
    }}
    width="100%"
  >
    <ActionLabelTitle />
  </Example>
  <Example
    height={{ min: 'small' }}
    bestPractice={{
      type: 'dont',
      message: `Don’t use a different verb for the primary action than the layer title's verb.`,
    }}
    width="100%"
  >
    <ActionLabelTitle bestPractice={false} />
  </Example>
</BestPracticeGroup>

## Overflow behavior

If a layer contains filters, the footer actions should be persistent and sticky at the bottom of the layer so that the user always has access to apply, reset, or cancel out of the filter view and return to the data set.

If the layer contains a form, the footer actions should be at the bottom of the form to encourage the user to see the entire form before submission.

## Accessibility

### Layer titles

- Layer headings should be semantically correct.
- Treat a Layer as if it were a stand alone page, with the exception that the first heading within a Layer should be an `h2` or `<Heading level={2} />`.
- All subsequent headings should follow typical [semantic heading structure](/foundation/typography#semantic-usage-of-heading-levels).

### Close button

When using a Layer with `modal={false}`, it is critical that the focus is moved to the "Close" button inside the Layer. Give the close button an `a11yTitle` that provides the user with context that they are in a Layer.

For example, implementation of this "Close" button for a Layer would be:

```
<Button
  a11yTitle={`You are in a layer containing a form to add new hosts.
  To close this layer, press Enter.`}
  icon={<FormClose />}
  onClick={() => setShowLayer(false)}
  autoFocus
/>
```
